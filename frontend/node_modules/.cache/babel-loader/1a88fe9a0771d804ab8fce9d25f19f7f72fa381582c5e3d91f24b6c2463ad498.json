{"ast":null,"code":"import{useEffect}from\"react\";import{useRef,useState}from\"react\";import{useParams}from\"react-router-dom\";import{Container,Row,Col}from\"react-bootstrap\";import ReviewForm from\"./reviewForm/ReviewForm\";import api from\"../../api/axiosConfig\";import SessionManager from\"../../SessionManager\";import\"./Review.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Reviews(_ref){let{getMovieData,movie,reviews,setReviews}=_ref;const{token}=SessionManager();const revText=useRef();const params=useParams();const movieId=params.movieId;const[errorMessage,setErrorMessage]=useState(\"\");useEffect(()=>{getMovieData(movieId);},[]);function changeErrorMessage(errorMessage){setErrorMessage(errorMessage);setTimeout(()=>{setErrorMessage(\"\");},3000);}const addReview=async e=>{e.preventDefault();const rev=revText.current;if(token===\"\"){console.log(\"token no\");changeErrorMessage(\"You have to be logged in to add a new review.\");}else{try{console.log(\"Bearer \".concat(token.slice(1,-1)));const response=await api.post(\"/api/v1/reviews\",{reviewBody:rev.value,imdbId:movieId},{headers:{Authorization:\"Bearer \".concat(token.slice(1,-1))}});const updatedReviews=[...reviews,{body:rev.value}];rev.value=\"\";setReviews(updatedReviews);}catch(err){console.error(err);}}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"section-name\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Reviews\"})})})}),/*#__PURE__*/_jsxs(Row,{className:\"mt-2\",children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"poster-container\",children:/*#__PURE__*/_jsx(\"img\",{src:movie===null||movie===void 0?void 0:movie.poster,alt:\"\"})})}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(ReviewForm,{handleSubmit:addReview,revText:revText,labelText:\"Write a Review?\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4\",children:errorMessage})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"hr\",{})})})]}),reviews===null||reviews===void 0?void 0:reviews.map(r=>{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:r.body})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{style:{color:\"yellow\"},children:[\"~ \",r.username]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"hr\",{})})})]},r.body);})]})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"hr\",{})})})]});}export default Reviews;","map":{"version":3,"names":["useEffect","useRef","useState","useParams","Container","Row","Col","ReviewForm","api","SessionManager","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Reviews","_ref","getMovieData","movie","reviews","setReviews","token","revText","params","movieId","errorMessage","setErrorMessage","changeErrorMessage","setTimeout","addReview","e","preventDefault","rev","current","console","log","concat","slice","response","post","reviewBody","value","imdbId","headers","Authorization","updatedReviews","body","err","error","children","className","src","poster","alt","handleSubmit","labelText","map","r","style","color","username"],"sources":["C:/Users/SANTI/Documents/GitHub/movie-review-app/frontend/src/components/reviews/Reviews.js"],"sourcesContent":["import { useEffect } from \"react\";\r\nimport { useRef, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { Container, Row, Col } from \"react-bootstrap\";\r\nimport ReviewForm from \"./reviewForm/ReviewForm\";\r\nimport api from \"../../api/axiosConfig\";\r\nimport SessionManager from \"../../SessionManager\";\r\nimport \"./Review.css\";\r\n\r\nfunction Reviews({ getMovieData, movie, reviews, setReviews }) {\r\n  const { token } = SessionManager();\r\n  const revText = useRef();\r\n  const params = useParams();\r\n  const movieId = params.movieId;\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    getMovieData(movieId);\r\n  }, []);\r\n\r\n  function changeErrorMessage(errorMessage) {\r\n    setErrorMessage(errorMessage);\r\n    setTimeout(() => {\r\n      setErrorMessage(\"\");\r\n    }, 3000);\r\n  }\r\n\r\n  const addReview = async (e) => {\r\n    e.preventDefault();\r\n    const rev = revText.current;\r\n\r\n    if (token === \"\") {\r\n      console.log(\"token no\");\r\n      changeErrorMessage(\"You have to be logged in to add a new review.\");\r\n    } else {\r\n      try {\r\n        console.log(`Bearer ${token.slice(1, -1)}`);\r\n        const response = await api.post(\r\n          \"/api/v1/reviews\",\r\n          {\r\n            reviewBody: rev.value,\r\n            imdbId: movieId,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${token.slice(1, -1)}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        const updatedReviews = [...reviews, { body: rev.value }];\r\n\r\n        rev.value = \"\";\r\n\r\n        setReviews(updatedReviews);\r\n      } catch (err) {\r\n        console.error(err);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Row>\r\n        <Col>\r\n          <div className=\"section-name\">\r\n            <h3>Reviews</h3>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n      <Row className=\"mt-2\">\r\n        <Col>\r\n          <div className=\"poster-container\">\r\n            <img src={movie?.poster} alt=\"\" />\r\n          </div>\r\n        </Col>\r\n        <Col>\r\n          {\r\n            <>\r\n              <Row>\r\n                <Col>\r\n                  <ReviewForm\r\n                    handleSubmit={addReview}\r\n                    revText={revText}\r\n                    labelText=\"Write a Review?\"\r\n                  />\r\n                  <p className=\"mt-4\">{errorMessage}</p>\r\n                </Col>\r\n              </Row>\r\n              <Row>\r\n                <Col>\r\n                  <hr />\r\n                </Col>\r\n              </Row>\r\n            </>\r\n          }\r\n          {reviews?.map((r) => {\r\n            return (\r\n              <div key={r.body}>\r\n                <Row>\r\n                  <Col>{r.body}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col style={{ color: \"yellow\" }}>~ {r.username}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col>\r\n                    <hr />\r\n                  </Col>\r\n                </Row>\r\n              </div>\r\n            );\r\n          })}\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n          <hr />\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Reviews;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}